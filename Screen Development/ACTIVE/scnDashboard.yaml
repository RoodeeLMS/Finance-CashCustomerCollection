Screens:
  scnDashboard:
    Properties:
      Fill: =RGBA(243, 242, 241, 1)
      LoadingSpinnerColor: =RGBA(0, 101, 161, 1)
      OnVisible: |-
        =// Initialize navigation and menu
        Set(_showMenu, false);
        Set(_refreshTrigger, false);
        Set(_showDatePicker, false);
        UpdateContext({currentScreen: "Daily Control Center"});

        // Initialize selected date to today if not set
        If(
            IsBlank(_selectedDate),
            Set(_selectedDate, Today())
        );

        // Refresh data sources (initial load only)
        Refresh('[THFinanceCashCollection]Process Logs');
        Refresh('[THFinanceCashCollection]Emaillogs');
        Refresh('[THFinanceCashCollection]Transactions');
        Refresh('[THFinanceCashCollection]Customers');
    Children:
      - DCC_Container:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            DropShadow: =DropShadow.None
            Height: =Parent.Height
            Width: =Parent.Width
          Children:
            - DCC_Header:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.Regular
                  Fill: =RGBA(0, 101, 161, 1)
                  Height: =55
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =10
                  PaddingLeft: =15
                  RadiusBottomLeft: =8
                  RadiusBottomRight: =8
                  RadiusTopLeft: =8
                  RadiusTopRight: =8
                  Width: =Parent.Width - 20
                  X: =10
                  Y: =10
                Children:
                  - DCC_MenuIcon:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        Color: =RGBA(255, 255, 255, 1)
                        Height: =50
                        Icon: =Icon.Hamburger
                        OnSelect: =Set(_showMenu, !_showMenu)
                        PaddingBottom: =10
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =10
                        Width: =50
                  - DCC_HeaderTitle:
                      Control: Text@0.0.51
                      Properties:
                        Font: =Font.Lato
                        FontColor: =Color.White
                        Height: =50
                        PaddingLeft: =20
                        Size: =25
                        Text: ="Daily Control Center"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Medium
                        Width: =Parent.Width - DCC_MenuIcon.Width - 40
            - DCC_Content:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Fill: =RGBA(243, 242, 241, 1)
                  Height: =Parent.Height - 75
                  Width: =Parent.Width - 20
                  X: =10
                  Y: =75
                Children:
                  - DCC_DatePickerSection:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.Regular
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =140
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =15
                        PaddingBottom: =15
                        PaddingLeft: =20
                        PaddingRight: =20
                        PaddingTop: =15
                        RadiusBottomLeft: =10
                        RadiusBottomRight: =10
                        RadiusTopLeft: =10
                        RadiusTopRight: =10
                        Width: =Parent.Width - 20
                        X: =10
                        Y: =10
                      Children:
                        - DCC_DatePickerTitleRow:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =0
                              Height: =40
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutGap: =10
                              LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                              LayoutMinHeight: =40
                              LayoutMinWidth: =100
                              Width: =Parent.Width - 40
                            Children:
                              - DCC_DatePickerTitle:
                                  Control: Text@0.0.51
                                  Properties:
                                    Font: =Font.Lato
                                    FontColor: =RGBA(0, 101, 161, 1)
                                    Height: =40
                                    Size: =20
                                    Text: ="Audit Date Selection"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Bold
                                    Width: =400
                              - DCC_RefreshButton:
                                  Control: Button@0.0.45
                                  Properties:
                                    BasePaletteColor: =RGBA(0, 101, 161, 1)
                                    Height: =36
                                    Icon: ="Refresh"
                                    OnSelect: =Set(_refreshTrigger, !_refreshTrigger)
                                    Text: ="‚Üª Refresh"
                                    Width: =120
                        - DCC_DateNavigationRow:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              FillPortions: =0
                              Height: =50
                              LayoutAlignItems: =LayoutAlignItems.Center
                              LayoutDirection: =LayoutDirection.Horizontal
                              LayoutGap: =10
                              LayoutMinHeight: =50
                              LayoutMinWidth: =100
                              Width: =Parent.Width - 40
                            Children:
                              - DCC_ViewDateLabel:
                                  Control: Text@0.0.51
                                  Properties:
                                    Font: =Font.Lato
                                    FontColor: =RGBA(100, 100, 100, 1)
                                    Height: =40
                                    Text: ="View Date:"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =100
                              - DCC_PreviousDayButton:
                                  Control: Button@0.0.45
                                  Properties:
                                    BasePaletteColor: =RGBA(0, 101, 161, 1)
                                    Height: =40
                                    OnSelect: |-
                                      =Set(_selectedDate, DateAdd(_selectedDate, -1, TimeUnit.Days));
                                      Set(_refreshTrigger, !_refreshTrigger)
                                    Text: ="‚óÑ Previous"
                                    Width: =120
                              - DCC_DateDisplay:
                                  Control: Text@0.0.51
                                  Properties:
                                    Align: ='TextCanvas.Align'.Center
                                    Fill: =RGBA(243, 242, 241, 1)
                                    Font: =Font.Lato
                                    FontColor: =RGBA(0, 0, 0, 1)
                                    Height: =40
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    Text: =Text(_selectedDate, "[$-th-TH]dd/mm/yyyy") & If(_selectedDate = Today(), " (Today)", "")
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =180
                              - DCC_NextDayButton:
                                  Control: Button@0.0.45
                                  Properties:
                                    BasePaletteColor: =RGBA(0, 101, 161, 1)
                                    DisplayMode: =If(_selectedDate >= Today(), DisplayMode.Disabled, DisplayMode.Edit)
                                    Height: =40
                                    OnSelect: |-
                                      =Set(_selectedDate, DateAdd(_selectedDate, 1, TimeUnit.Days));
                                      Set(_refreshTrigger, !_refreshTrigger)
                                    Text: ="Next ‚ñ∫"
                                    Width: =120
                              - DCC_TodayButton:
                                  Control: Button@0.0.45
                                  Properties:
                                    BasePaletteColor: =If(_selectedDate = Today(), RGBA(16, 124, 16, 1), RGBA(0, 101, 161, 1))
                                    Height: =40
                                    OnSelect: |-
                                      =Set(_selectedDate, Today());
                                      Set(_refreshTrigger, !_refreshTrigger)
                                    Text: ="Today"
                                    Width: =100
                              - DCC_PickDateButton:
                                  Control: Button@0.0.45
                                  Properties:
                                    BasePaletteColor: =RGBA(100, 81, 61, 1)
                                    Height: =40
                                    OnSelect: =Set(_showDatePicker, !_showDatePicker)
                                    Text: |-
                                      ="üìÖ Pick Date"
                                    Width: =120
                  - DCC_MainScrollContainer:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        Fill: =RGBA(243, 242, 241, 1)
                        Height: =Parent.Height - 170
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =24
                        LayoutOverflowY: =LayoutOverflow.Scroll
                        PaddingBottom: =20
                        Width: =Parent.Width - 20
                        X: =10
                        Y: =160
                      Children:
                        - DCC_SystemStatusCard:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =RGBA(255, 255, 255, 1)
                              FillPortions: =0
                              Height: =220
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =15
                              LayoutMinHeight: =220
                              LayoutMinWidth: =200
                              PaddingBottom: =15
                              PaddingLeft: =20
                              PaddingRight: =20
                              PaddingTop: =15
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Parent.Width - 20
                            Children:
                              - DCC_StatusCardHeader:
                                  Control: Text@0.0.51
                                  Properties:
                                    Font: =Font.Lato
                                    FontColor: =RGBA(0, 101, 161, 1)
                                    Height: =30
                                    Size: =16
                                    Text: ="System Status - " & Text(_selectedDate, "[$-th-TH]dd/mm/yyyy")
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =Parent.Width - 40
                              - DCC_StatusPanelsRow:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    DropShadow: =DropShadow.None
                                    FillPortions: =0
                                    Height: =150
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutGap: =20
                                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                    LayoutMinHeight: =150
                                    LayoutMinWidth: =200
                                    Width: =Parent.Width - 40
                                  Children:
                                    - DCC_SAPImportPanel:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Center
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutGap: =10
                                          LayoutJustifyContent: =LayoutJustifyContent.Center
                                          LayoutMinHeight: =150
                                          LayoutMinWidth: =200
                                        Children:
                                          - DCC_SAPIcon:
                                              Control: Classic/Icon@2.5.0
                                              Properties:
                                                Color: |-
                                                  =With(
                                                      {
                                                          _trigger: _refreshTrigger,
                                                          _log: First(Filter('[THFinanceCashCollection]Process Logs', cr7bb_processdate = Text(_selectedDate, "yyyy-mm-dd")))
                                                      },
                                                      If(
                                                          !IsBlank(_log) && _log.cr7bb_status = "Completed",
                                                          RGBA(16, 124, 16, 1),
                                                          If(
                                                              !IsBlank(_log) && _log.cr7bb_status = "Failed",
                                                              RGBA(168, 0, 0, 1),
                                                              RGBA(96, 94, 92, 1)
                                                          )
                                                      )
                                                  )
                                                Icon: |-
                                                  =With(
                                                      {
                                                          _trigger: _refreshTrigger,
                                                          _log: First(Filter('[THFinanceCashCollection]Process Logs', cr7bb_processdate = Text(_selectedDate, "yyyy-mm-dd")))
                                                      },
                                                      If(
                                                          !IsBlank(_log) && _log.cr7bb_status = "Completed",
                                                          Icon.CheckBadge,
                                                          If(
                                                              !IsBlank(_log) && _log.cr7bb_status = "Failed",
                                                              Icon.CancelBadge,
                                                              Icon.Clock
                                                          )
                                                      )
                                                  )
                                          - DCC_SAPTitle:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Center
                                                Font: =Font.Lato
                                                FontColor: =RGBA(0, 0, 0, 1)
                                                Height: =25
                                                Text: ="SAP Import"
                                                VerticalAlign: =VerticalAlign.Middle
                                                Weight: ='TextCanvas.Weight'.Bold
                                                Width: =150
                                          - DCC_SAPStatus:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Center
                                                AutoHeight: =true
                                                Font: =Font.Lato
                                                FontColor: =RGBA(100, 100, 100, 1)
                                                Size: =12
                                                Text: |-
                                                  =With(
                                                      {
                                                          _trigger: _refreshTrigger,
                                                          _log: First(Filter('[THFinanceCashCollection]Process Logs', cr7bb_processdate = Text(_selectedDate, "yyyy-mm-dd")))
                                                      },
                                                      If(
                                                          IsBlank(_log),
                                                          "No run recorded",
                                                          _log.cr7bb_status & " at " & Text(DateTimeValue(_log.cr7bb_processdate), "[$-th-TH]hh:mm")
                                                      )
                                                  )
                                                Width: =200
                                          - DCC_SAPRecordCount:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Center
                                                AutoHeight: =true
                                                Font: =Font.Lato
                                                FontColor: =RGBA(100, 100, 100, 1)
                                                Size: =12
                                                Text: |-
                                                  =With(
                                                      {
                                                          _trigger: _refreshTrigger,
                                                          _log: First(Filter('[THFinanceCashCollection]Process Logs', cr7bb_processdate = Text(_selectedDate, "yyyy-mm-dd")))
                                                      },
                                                      If(
                                                          !IsBlank(_log),
                                                          _log.cr7bb_transactionsprocessed & " transactions processed",
                                                          ""
                                                      )
                                                  )
                                                Width: =200
                                    - DCC_EmailEnginePanel:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          LayoutAlignItems: =LayoutAlignItems.Center
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutGap: =10
                                          LayoutJustifyContent: =LayoutJustifyContent.Center
                                          LayoutMinHeight: =150
                                          LayoutMinWidth: =200
                                        Children:
                                          - DCC_EmailIcon:
                                              Control: Classic/Icon@2.5.0
                                              Properties:
                                                Color: |-
                                                  =With(
                                                      {
                                                          _trigger: _refreshTrigger,
                                                          _sent: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Success)),
                                                          _failed: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Failed))
                                                      },
                                                      If(
                                                          _sent > 0 && _failed = 0,
                                                          RGBA(16, 124, 16, 1),
                                                          If(
                                                              _failed > 0,
                                                              RGBA(255, 185, 0, 1),
                                                              RGBA(96, 94, 92, 1)
                                                          )
                                                      )
                                                  )
                                                Icon: |-
                                                  =With(
                                                      {
                                                          _trigger: _refreshTrigger,
                                                          _sent: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Success)),
                                                          _failed: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Failed))
                                                      },
                                                      If(
                                                          _sent > 0 && _failed = 0,
                                                          Icon.CheckBadge,
                                                          If(
                                                              _failed > 0,
                                                              Icon.Warning,
                                                              Icon.Clock
                                                          )
                                                      )
                                                  )
                                          - DCC_EmailTitle:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Center
                                                Font: =Font.Lato
                                                FontColor: =RGBA(0, 0, 0, 1)
                                                Height: =25
                                                Text: |-
                                                  ="üìß Email Engine"
                                                VerticalAlign: =VerticalAlign.Middle
                                                Weight: ='TextCanvas.Weight'.Bold
                                                Width: =150
                                          - DCC_EmailStatus:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Center
                                                AutoHeight: =true
                                                Font: =Font.Lato
                                                FontColor: =RGBA(100, 100, 100, 1)
                                                Size: =12
                                                Text: |-
                                                  =With(
                                                      {
                                                          _trigger: _refreshTrigger,
                                                          _sent: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Success)),
                                                          _failed: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Failed))
                                                      },
                                                      If(
                                                          _sent = 0 && _failed = 0,
                                                          "No emails sent",
                                                          _sent & " sent, " & _failed & " failed"
                                                      )
                                                  )
                                                Width: =200
                                          - DCC_EmailSkipped:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Center
                                                AutoHeight: =true
                                                Font: =Font.Lato
                                                FontColor: =RGBA(100, 100, 100, 1)
                                                Size: =12
                                                Text: |-
                                                  =With(
                                                      {
                                                          _trigger: _refreshTrigger,
                                                          _skipped: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Pending))
                                                      },
                                                      If(
                                                          _skipped > 0,
                                                          _skipped & " customers skipped (CN > DN)",
                                                          ""
                                                      )
                                                  )
                                                Width: =200
                        - DCC_QuickActionsCard:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =RGBA(255, 255, 255, 1)
                              FillPortions: =0
                              Height: =140
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =15
                              LayoutMinHeight: =140
                              LayoutMinWidth: =200
                              PaddingBottom: =15
                              PaddingLeft: =20
                              PaddingRight: =20
                              PaddingTop: =15
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Parent.Width - 20
                            Children:
                              - DCC_QuickActionsHeader:
                                  Control: Text@0.0.51
                                  Properties:
                                    Font: =Font.Lato
                                    FontColor: =RGBA(0, 101, 161, 1)
                                    Height: =30
                                    Size: =16
                                    Text: ="Quick Actions"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =Parent.Width - 40
                              - DCC_QuickActionsButtonsRow:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    DropShadow: =DropShadow.None
                                    FillPortions: =0
                                    Height: =70
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutGap: =10
                                    LayoutMinHeight: =70
                                    LayoutMinWidth: =200
                                    LayoutWrap: =true
                                    Width: =Parent.Width - 40
                                  Children:
                                    - DCC_ReviewEmailsButton:
                                        Control: Button@0.0.45
                                        Properties:
                                          BasePaletteColor: =RGBA(0, 101, 161, 1)
                                          Height: =40
                                          OnSelect: |-
                                            =Set(gblFilterDate, _selectedDate);
                                            Navigate(scnEmailMonitor)
                                          Text: |-
                                            ="üìß Review Emails"
                                          Width: =150
                                    - DCC_FailedEmailsButton:
                                        Control: Button@0.0.45
                                        Properties:
                                          BasePaletteColor: |-
                                            =With(
                                                {
                                                    _trigger: _refreshTrigger,
                                                    _failed: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Failed))
                                                },
                                                If(_failed > 0, RGBA(168, 0, 0, 1), RGBA(200, 198, 196, 1))
                                            )
                                          DisplayMode: |-
                                            =With(
                                                {
                                                    _trigger: _refreshTrigger,
                                                    _failed: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Failed))
                                                },
                                                If(_failed > 0, DisplayMode.Edit, DisplayMode.Disabled)
                                            )
                                          Height: =40
                                          OnSelect: |-
                                            =Set(gblFilterDate, _selectedDate);
                                            Set(gblEmailStatusFilter, "Failed");
                                            Navigate(scnEmailMonitor)
                                          Text: |-
                                            =With(
                                                {
                                                    _trigger: _refreshTrigger,
                                                    _failed: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate && cr7bb_sendstatus = 'Send Status Choice'.Failed))
                                                },
                                                "‚ö†Ô∏è Failed (" & _failed & ")"
                                            )
                                          Width: =150
                                    - DCC_CustomersButton:
                                        Control: Button@0.0.45
                                        Properties:
                                          BasePaletteColor: =RGBA(100, 81, 61, 1)
                                          Height: =40
                                          OnSelect: =Navigate(scnCustomer)
                                          Text: |-
                                            ="üîç Customers"
                                          Width: =150
                                    - DCC_TransactionsButton:
                                        Control: Button@0.0.45
                                        Properties:
                                          BasePaletteColor: =RGBA(0, 101, 161, 1)
                                          Height: =40
                                          OnSelect: |-
                                            =Set(gblFilterDate, _selectedDate);
                                            Navigate(scnTransactions)
                                          Text: |-
                                            ="üìä Transactions"
                                          Width: =150
                                    - DCC_ExportButton:
                                        Control: Button@0.0.45
                                        Properties:
                                          BasePaletteColor: =RGBA(100, 81, 61, 1)
                                          Height: =40
                                          OnSelect: =Notify("Export functionality coming soon", NotificationType.Information)
                                          Text: |-
                                            ="üìÑ Export Report"
                                          Width: =150
                        - DCC_ActivitySummaryCard:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              Fill: =RGBA(255, 255, 255, 1)
                              FillPortions: =0
                              Height: =450
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =15
                              LayoutMinHeight: =450
                              LayoutMinWidth: =200
                              PaddingBottom: =15
                              PaddingLeft: =20
                              PaddingRight: =20
                              PaddingTop: =15
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =Parent.Width - 20
                            Children:
                              - DCC_ActivityHeader:
                                  Control: Text@0.0.51
                                  Properties:
                                    Font: =Font.Lato
                                    FontColor: =RGBA(0, 101, 161, 1)
                                    Height: =30
                                    Size: =16
                                    Text: |-
                                      =With(
                                          {
                                              _trigger: _refreshTrigger,
                                              _count: CountRows(Filter('[THFinanceCashCollection]Emaillogs', DateValue(cr7bb_sentdatetime) = _selectedDate))
                                          },
                                          "Activity - " & Text(_selectedDate, "[$-th-TH]dd/mm/yyyy") & " (" & _count & " emails)"
                                      )
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Semibold
                                    Width: =Parent.Width - 40
                              - DCC_ActivityGallery:
                                  Control: Gallery@2.15.0
                                  Variant: Vertical
                                  Properties:
                                    Height: =350
                                    Items: |-
                                      =If(
                                          _refreshTrigger || !_refreshTrigger,
                                          FirstN(
                                              Sort(
                                                  Filter(
                                                      '[THFinanceCashCollection]Emaillogs',
                                                      DateValue(cr7bb_sentdatetime) = _selectedDate
                                                  ),
                                                  cr7bb_sentdatetime,
                                                  SortOrder.Descending
                                              ),
                                              10
                                          )
                                      )
                                    TemplatePadding: =0
                                    TemplateSize: =70
                                    Width: =Parent.Width - 40
                                  Children:
                                    - DCC_GalleryItemContainer:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          Fill: =If(Mod(ThisItem.Value, 2) = 0, RGBA(250, 250, 250, 1), RGBA(255, 255, 255, 1))
                                          Height: =70
                                          LayoutAlignItems: =LayoutAlignItems.Center
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          LayoutGap: =15
                                          PaddingBottom: =10
                                          PaddingLeft: =15
                                          PaddingRight: =15
                                          PaddingTop: =10
                                          Width: =Parent.TemplateWidth
                                        Children:
                                          - DCC_ActivityIcon:
                                              Control: Classic/Icon@2.5.0
                                              Properties:
                                                Color: |-
                                                  =If(
                                                      ThisItem.cr7bb_sendstatus = 'Send Status Choice'.Success,
                                                      RGBA(16, 124, 16, 1),
                                                      If(
                                                          ThisItem.cr7bb_sendstatus = 'Send Status Choice'.Failed,
                                                          RGBA(168, 0, 0, 1),
                                                          RGBA(96, 94, 92, 1)
                                                      )
                                                  )
                                                Height: =40
                                                Icon: |-
                                                  =If(
                                                      ThisItem.cr7bb_sendstatus = 'Send Status Choice'.Success,
                                                      Icon.CheckBadge,
                                                      If(
                                                          ThisItem.cr7bb_sendstatus = 'Send Status Choice'.Failed,
                                                          Icon.Warning,
                                                          Icon.Send
                                                      )
                                                  )
                                                Width: =40
                                          - DCC_ActivityDetailsContainer:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                DropShadow: =DropShadow.None
                                                LayoutDirection: =LayoutDirection.Vertical
                                                LayoutGap: =5
                                                LayoutMinHeight: =50
                                                LayoutMinWidth: =100
                                              Children:
                                                - DCC_ActivityText:
                                                    Control: Text@0.0.51
                                                    Properties:
                                                      AutoHeight: =true
                                                      Font: =Font.Lato
                                                      FontColor: =RGBA(0, 0, 0, 1)
                                                      Size: =13
                                                      Text: ="Email " & Text(ThisItem.cr7bb_sendstatus) & " to " & ThisItem.Customer.'[THFinanceCashCollection]Customer'
                                                      Weight: ='TextCanvas.Weight'.Semibold
                                                      Width: =400
                                                - DCC_ActivityTimestamp:
                                                    Control: Text@0.0.51
                                                    Properties:
                                                      AutoHeight: =true
                                                      Font: =Font.Lato
                                                      FontColor: =RGBA(100, 100, 100, 1)
                                                      Size: =11
                                                      Text: =Text(ThisItem.cr7bb_sentdatetime, "[$-th-TH]hh:mm:ss")
                                                      Width: =400
                                          - DCC_ActivityStatusBadge:
                                              Control: Text@0.0.51
                                              Properties:
                                                Align: ='TextCanvas.Align'.Center
                                                Font: =Font.Lato
                                                FontColor: |-
                                                  =If(
                                                      ThisItem.cr7bb_sendstatus = 'Send Status Choice'.Success,
                                                      RGBA(16, 124, 16, 1),
                                                      If(
                                                          ThisItem.cr7bb_sendstatus = 'Send Status Choice'.Failed,
                                                          RGBA(168, 0, 0, 1),
                                                          RGBA(96, 94, 92, 1)
                                                      )
                                                  )
                                                Height: =50
                                                Size: =12
                                                Text: =Text(ThisItem.cr7bb_sendstatus)
                                                VerticalAlign: =VerticalAlign.Middle
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =100
                                          - DCC_ActivityViewButton:
                                              Control: Button@0.0.45
                                              Properties:
                                                BasePaletteColor: =RGBA(0, 101, 161, 1)
                                                Height: =36
                                                OnSelect: |-
                                                  =Set(gblSelectedEmail, ThisItem);
                                                  Navigate(scnEmailMonitor)
                                                Text: ="View"
                                                Width: =80
                  - DCC_DatePickerOverlay:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        Fill: =RGBA(0, 0, 0, 0.5)
                        Height: =Parent.Height
                        Visible: =_showDatePicker
                        Width: =Parent.Width
                      Children:
                        - DCC_DatePickerModal:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.Regular
                              Fill: =RGBA(255, 255, 255, 1)
                              Height: =450
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =20
                              PaddingBottom: =30
                              PaddingLeft: =30
                              PaddingRight: =30
                              PaddingTop: =30
                              RadiusBottomLeft: =10
                              RadiusBottomRight: =10
                              RadiusTopLeft: =10
                              RadiusTopRight: =10
                              Width: =400
                              X: =(Parent.Width - 400) / 2
                              Y: =(Parent.Height - 450) / 2
                            Children:
                              - DCC_DatePickerModalTitle:
                                  Control: Text@0.0.51
                                  Properties:
                                    Font: =Font.Lato
                                    FontColor: =RGBA(0, 101, 161, 1)
                                    Height: =40
                                    Size: =20
                                    Text: ="Select Audit Date"
                                    VerticalAlign: =VerticalAlign.Middle
                                    Weight: ='TextCanvas.Weight'.Bold
                                    Width: =340
                              - DCC_DatePickerControl:
                                  Control: DatePicker@0.0.46
                                  Properties:
                                    BasePaletteColor: =RGBA(0, 101, 161, 1)
                                    Height: =280
                                    SelectedDate: =_selectedDate
                                    Width: =340
                              - DCC_DatePickerModalButtons:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    DropShadow: =DropShadow.None
                                    FillPortions: =0
                                    Height: =50
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutGap: =15
                                    LayoutJustifyContent: =LayoutJustifyContent.End
                                    LayoutMinHeight: =50
                                    LayoutMinWidth: =100
                                    Width: =340
                                  Children:
                                    - DCC_DatePickerCancelButton:
                                        Control: Button@0.0.45
                                        Properties:
                                          BasePaletteColor: =RGBA(128, 128, 128, 1)
                                          Height: =40
                                          OnSelect: =Set(_showDatePicker, false)
                                          Text: ="Cancel"
                                          Width: =100
                                    - DCC_DatePickerSelectButton:
                                        Control: Button@0.0.45
                                        Properties:
                                          BasePaletteColor: =RGBA(0, 101, 161, 1)
                                          Height: =40
                                          OnSelect: |-
                                            =Set(_selectedDate, DCC_DatePickerControl.SelectedDate);
                                            Set(_showDatePicker, false);
                                            Set(_refreshTrigger, !_refreshTrigger)
                                          Text: ="Select Date"
                                          Width: =120
            - DCC_NavigationMenu:
                Control: CanvasComponent
                ComponentName: NavigationMenu
                Properties:
                  Fill: =RGBA(255, 255, 255, 0.5)
                  Height: =Parent.Height - 70
                  Visible: =If(_showMenu, true, false)
                  Width: =260
                  Y: =70
                  navItems: =Navigation
                  navSelected: =currentScreen
