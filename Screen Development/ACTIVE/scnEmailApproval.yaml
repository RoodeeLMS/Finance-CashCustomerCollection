Screens:
  scnEmailApproval:
    Properties:
      Fill: =RGBA(243, 242, 241, 1)
      LoadingSpinnerColor: =RGBA(0, 101, 161, 1)
      OnVisible: |-
        =UpdateContext({currentScreen: "Email Approval"});
        Set(_showMenu, false);
        Set(_isLoading, true);
        Set(_filterDate, Today());
        Set(_showPreview, false);
        Set(_selectedEmail, Blank());
        Set(_refreshTrigger, false);

        Set(
            gblAutoApprove,
            If(
                IsBlank(LookUp('[THFinanceCashCollection]Settings', cr7bb_settingkey = "AutoApproveEmails").cr7bb_settingvalue),
                true,
                Value(LookUp('[THFinanceCashCollection]Settings', cr7bb_settingkey = "AutoApproveEmails").cr7bb_settingvalue)
            )
        );

        ClearCollect(
            colDraftEmails,
            SortByColumns(
                Filter(
                    '[THFinanceCashCollection]Emaillogs',
                    cr7bb_processdate = _filterDate &&
                    (cr7bb_sendstatus = 'Send Status Choice'.Pending ||
                     cr7bb_sendstatus = 'Send Status Choice'.Approved)
                ),
                "cr7bb_maxdaycount", SortOrder.Descending,
                "cr7bb_totalamount", SortOrder.Descending
            )
        );

        Clear(colSelectedEmails);

        If(
            gblAutoApprove,
            ClearCollect(colSelectedEmails, colDraftEmails)
        );

        Set(_isLoading, false);
    Children:
      - EmailApprv_Container:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            DropShadow: =DropShadow.None
            Height: =Parent.Height
            Width: =Parent.Width
          Children:
            - EmailApprv_Header:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.Regular
                  Fill: =RGBA(0, 101, 161, 1)
                  Height: =55
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =10
                  LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                  LayoutMinHeight: =55
                  LayoutMinWidth: =100
                  PaddingLeft: =15
                  PaddingRight: =15
                  RadiusBottomLeft: =8
                  RadiusBottomRight: =8
                  RadiusTopLeft: =8
                  RadiusTopRight: =8
                  Width: =Parent.Width - 20
                  X: =10
                  Y: =10
                Children:
                  - EmailApprv_HeaderLeft:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =10
                        LayoutMinHeight: =50
                        LayoutMinWidth: =100
                      Children:
                        - EmailApprv_MenuIcon:
                            Control: Classic/Icon@2.5.0
                            Properties:
                              Color: =RGBA(255, 255, 255, 1)
                              Height: =50
                              Icon: =Icon.Hamburger
                              OnSelect: =Set(_showMenu, !_showMenu)
                              PaddingBottom: =10
                              PaddingLeft: =10
                              PaddingRight: =10
                              PaddingTop: =10
                              Width: =50
                        - EmailApprv_HeaderTitle:
                            Control: Text@0.0.51
                            Properties:
                              Font: =Font.Lato
                              FontColor: =Color.White
                              Height: =50
                              PaddingLeft: =20
                              Size: =25
                              Text: ="Email Approval & Send"
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Medium
                              Width: =Parent.Width - EmailApprv_MenuIcon.Width - 40
            - EmailApprv_FilterBar:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.Regular
                  Fill: =RGBA(255, 255, 255, 1)
                  Height: =70
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =15
                  LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                  LayoutMinHeight: =70
                  LayoutMinWidth: =100
                  PaddingLeft: =20
                  PaddingRight: =20
                  RadiusBottomLeft: =8
                  RadiusBottomRight: =8
                  RadiusTopLeft: =8
                  RadiusTopRight: =8
                  Width: =Parent.Width - 20
                  X: =10
                  Y: =75
                Children:
                  - EmailApprv_FilterLeft:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =1
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =15
                        LayoutMinHeight: =60
                        LayoutMinWidth: =100
                      Children:
                        - EmailApprv_DateLabel:
                            Control: Text@0.0.51
                            Properties:
                              Font: =Font.Lato
                              FontColor: =RGBA(50, 50, 50, 1)
                              Height: =40
                              Size: =14
                              Text: |-
                                ="Date: " & Text(_filterDate, "dd/mm/yyyy")
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =150
                        - EmailApprv_CountLabel:
                            Control: Text@0.0.51
                            Properties:
                              Font: =Font.Lato
                              FontColor: =RGBA(0, 101, 161, 1)
                              Height: =40
                              Size: =14
                              Text: |-
                                ="Customers: " & CountRows(colDraftEmails) & " Pending"
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Bold
                              Width: =200
                  - EmailApprv_FilterRight:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =10
                        LayoutMinHeight: =60
                        LayoutMinWidth: =100
                      Children:
                        - EmailApprv_RefreshBtn:
                            Control: Button@0.0.45
                            Properties:
                              Appearance: ='ButtonCanvas.Appearance'.Subtle
                              BasePaletteColor: =RGBA(0, 101, 161, 1)
                              Height: =36
                              Icon: ="Sync"
                              OnSelect: |-
                                =Set(_isLoading, true);
                                ClearCollect(
                                    colDraftEmails,
                                    SortByColumns(
                                        Filter(
                                            '[THFinanceCashCollection]Emaillogs',
                                            cr7bb_processdate = _filterDate &&
                                            (cr7bb_sendstatus = 'Send Status Choice'.Pending ||
                                             cr7bb_sendstatus = 'Send Status Choice'.Approved)
                                        ),
                                        "cr7bb_maxdaycount", SortOrder.Descending,
                                        "cr7bb_totalamount", SortOrder.Descending
                                    )
                                );
                                Set(_isLoading, false);
                                Notify("Data refreshed", NotificationType.Success);
                              Text: ="Refresh"
                              Width: =100
                        - EmailApprv_AutoApproveLabel:
                            Control: Text@0.0.51
                            Properties:
                              Font: =Font.Lato
                              FontColor: =RGBA(50, 50, 50, 1)
                              Height: =40
                              Size: =14
                              Text: |-
                                ="Auto-Approve: " & If(gblAutoApprove, "ON", "OFF")
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =120
            - EmailApprv_SplitContainer:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  DropShadow: =DropShadow.None
                  Fill: =RGBA(243, 242, 241, 1)
                  Height: =Parent.Height - 235
                  Width: =Parent.Width - 20
                  X: =10
                  Y: =155
                Children:
                  - EmailApprv_LeftPanel:
                      Control: GroupContainer@1.3.0
                      Variant: ManualLayout
                      Properties:
                        DropShadow: =DropShadow.Regular
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                        Width: =(Parent.Width / 2) - 10
                        X: =0
                        Y: =0
                      Children:
                        - EmailApprv_LeftPanelTitle:
                            Control: Text@0.0.51
                            Properties:
                              Font: =Font.Lato
                              FontColor: =RGBA(0, 101, 161, 1)
                              Height: =40
                              PaddingLeft: =15
                              Size: =16
                              Text: ="Draft Email List"
                              VerticalAlign: =VerticalAlign.Middle
                              Weight: ='TextCanvas.Weight'.Bold
                              Width: =Parent.Width - 30
                              X: =15
                              Y: =15
                        - EmailApprv_DraftGallery:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              Height: =Parent.Height - 70
                              Items: |-
                                =If(
                                    _refreshTrigger || !_refreshTrigger,
                                    SortByColumns(
                                        Filter(
                                            '[THFinanceCashCollection]Emaillogs',
                                            cr7bb_processdate = _filterDate &&
                                            (cr7bb_sendstatus = 'Send Status Choice'.Pending ||
                                             cr7bb_sendstatus = 'Send Status Choice'.Approved)
                                        ),
                                        "cr7bb_maxdaycount", SortOrder.Descending,
                                        "cr7bb_totalamount", SortOrder.Descending
                                    )
                                )
                              TemplatePadding: =5
                              TemplateSize: =130
                              Width: =Parent.Width - 20
                              X: =10
                              Y: =60
                            Children:
                              - EmailCard:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    DropShadow: =DropShadow.Light
                                    Fill: =RGBA(250, 250, 250, 1)
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutGap: =5
                                    LayoutMinHeight: =120
                                    LayoutMinWidth: =200
                                    PaddingBottom: =10
                                    PaddingLeft: =15
                                    PaddingRight: =15
                                    PaddingTop: =10
                                    RadiusBottomLeft: =8
                                    RadiusBottomRight: =8
                                    RadiusTopLeft: =8
                                    RadiusTopRight: =8
                                    Width: =Parent.TemplateWidth - 10
                                  Children:
                                    - EmailCard_CustomerRow:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          FillPortions: =0
                                          Height: =30
                                          LayoutAlignItems: =LayoutAlignItems.Center
                                          LayoutDirection: =LayoutDirection.Horizontal
                                          LayoutGap: =10
                                          LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                          LayoutMinHeight: =30
                                          LayoutMinWidth: =100
                                          Width: =Parent.Width - 30
                                        Children:
                                          - EmailCard_CustomerName:
                                              Control: Text@0.0.51
                                              Properties:
                                                AutoHeight: =true
                                                FillPortions: =1
                                                Font: =Font.Lato
                                                FontColor: =RGBA(0, 0, 0, 1)
                                                Size: =16
                                                Text: |-
                                                  =LookUp('[THFinanceCashCollection]Customers', cr7bb_customerid = ThisItem.cr7bb_customer).cr7bb_customername
                                                Weight: ='TextCanvas.Weight'.Semibold
                                          - EmailCard_StatusBadge:
                                              Control: GroupContainer@1.3.0
                                              Variant: AutoLayout
                                              Properties:
                                                DropShadow: =DropShadow.None
                                                Fill: |-
                                                  =If(
                                                      ThisItem.cr7bb_sendstatus = 'Send Status Choice'.Approved,
                                                      RGBA(0, 128, 96, 1),
                                                      RGBA(150, 150, 150, 1)
                                                  )
                                                FillPortions: =0
                                                Height: =24
                                                LayoutAlignItems: =LayoutAlignItems.Center
                                                LayoutDirection: =LayoutDirection.Horizontal
                                                LayoutGap: =0
                                                LayoutMinHeight: =24
                                                LayoutMinWidth: =60
                                                PaddingBottom: =4
                                                PaddingLeft: =8
                                                PaddingRight: =8
                                                PaddingTop: =4
                                                RadiusBottomLeft: =12
                                                RadiusBottomRight: =12
                                                RadiusTopLeft: =12
                                                RadiusTopRight: =12
                                              Children:
                                                - EmailCard_StatusText:
                                                    Control: Text@0.0.51
                                                    Properties:
                                                      Font: =Font.Lato
                                                      FontColor: =RGBA(255, 255, 255, 1)
                                                      Height: =20
                                                      Size: =11
                                                      Text: |-
                                                        =If(
                                                            ThisItem.cr7bb_sendstatus = 'Send Status Choice'.Approved,
                                                            "Approved",
                                                            "Pending"
                                                        )
                                                      VerticalAlign: =VerticalAlign.Middle
                                                      Weight: ='TextCanvas.Weight'.Semibold
                                                      Width: =60
                                    - EmailCard_Amount:
                                        Control: Text@0.0.51
                                        Properties:
                                          AutoHeight: =true
                                          Font: =Font.Lato
                                          FontColor: =RGBA(50, 50, 50, 1)
                                          Size: =14
                                          Text: |-
                                            ="Amount: ฿" & Text(ThisItem.cr7bb_totalamount, "#,##0.00") & " THB"
                                          Weight: ='TextCanvas.Weight'.Regular
                                          Width: =Parent.Width - 30
                                    - EmailCard_TransCount:
                                        Control: Text@0.0.51
                                        Properties:
                                          AutoHeight: =true
                                          Font: =Font.Lato
                                          FontColor: =RGBA(50, 50, 50, 1)
                                          Size: =14
                                          Text: |-
                                            ="Transactions: " & Text(ThisItem.cr7bb_transactioncount) & " DNs"
                                          Weight: ='TextCanvas.Weight'.Regular
                                          Width: =Parent.Width - 30
                                    - EmailCard_Template:
                                        Control: Text@0.0.51
                                        Properties:
                                          AutoHeight: =true
                                          Font: =Font.Lato
                                          FontColor: =RGBA(100, 100, 100, 1)
                                          Size: =13
                                          Text: |-
                                            ="Template " & Text(ThisItem.cr7bb_emailtemplate) & " (Day " & Text(ThisItem.cr7bb_maxdaycount) & ")"
                                          Weight: ='TextCanvas.Weight'.Regular
                                          Width: =Parent.Width - 30
                                    - EmailCard_ViewBtn:
                                        Control: Button@0.0.45
                                        Properties:
                                          BasePaletteColor: =RGBA(0, 101, 161, 1)
                                          Height: =32
                                          OnSelect: |-
                                            =Set(_selectedEmail, ThisItem);
                                            Set(_showPreview, true);
                                          Text: ="View Details"
                                          Width: =120
                  - EmailApprv_RightPanel:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.Regular
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =Parent.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =15
                        LayoutMinHeight: =200
                        LayoutMinWidth: =200
                        LayoutOverflowY: =LayoutOverflow.Scroll
                        PaddingBottom: =20
                        PaddingLeft: =20
                        PaddingRight: =20
                        PaddingTop: =20
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                        Visible: =!IsBlank(_selectedEmail)
                        Width: =(Parent.Width / 2) - 10
                        X: =(Parent.Width / 2) + 10
                        Y: =0
                      Children:
                        - Preview_Title:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              FontColor: =RGBA(0, 101, 161, 1)
                              Size: =18
                              Text: ="Email Preview"
                              Weight: ='TextCanvas.Weight'.Bold
                              Width: =Parent.Width - 40
                        - Preview_CustomerName:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              FontColor: =RGBA(0, 0, 0, 1)
                              Size: =16
                              Text: |-
                                =LookUp('[THFinanceCashCollection]Customers', cr7bb_customerid = _selectedEmail.cr7bb_customer).cr7bb_customername
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Parent.Width - 40
                        - Preview_ToLabel:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              FontColor: =RGBA(50, 50, 50, 1)
                              Size: =14
                              Text: |-
                                ="To: " & _selectedEmail.cr7bb_recipientemails
                              Weight: ='TextCanvas.Weight'.Regular
                              Width: =Parent.Width - 40
                        - Preview_CCLabel:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              FontColor: =RGBA(50, 50, 50, 1)
                              Size: =14
                              Text: |-
                                ="CC: " & _selectedEmail.cr7bb_ccemails
                              Weight: ='TextCanvas.Weight'.Regular
                              Width: =Parent.Width - 40
                        - Preview_SubjectLabel:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              FontColor: =RGBA(50, 50, 50, 1)
                              Size: =14
                              Text: |-
                                ="Subject: " & _selectedEmail.cr7bb_emailsubject
                              Weight: ='TextCanvas.Weight'.Regular
                              Width: =Parent.Width - 40
                        - Preview_TemplateLabel:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              FontColor: =RGBA(100, 100, 100, 1)
                              Size: =13
                              Text: |-
                                ="Template: " & Text(_selectedEmail.cr7bb_emailtemplate) & " (Day " & Text(_selectedEmail.cr7bb_maxdaycount) & ")"
                              Weight: ='TextCanvas.Weight'.Regular
                              Width: =Parent.Width - 40
                        - Preview_Divider:
                            Control: Text@0.0.51
                            Properties:
                              Font: =Font.Lato
                              FontColor: =RGBA(200, 200, 200, 1)
                              Height: =1
                              Size: =1
                              Text: =""
                              Width: =Parent.Width - 40
                        - Preview_TransactionTitle:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              FontColor: =RGBA(0, 101, 161, 1)
                              Size: =16
                              Text: ="Transaction Details"
                              Weight: ='TextCanvas.Weight'.Bold
                              Width: =Parent.Width - 40
                        - Preview_TransactionGallery:
                            Control: Gallery@2.15.0
                            Variant: Vertical
                            Properties:
                              Height: =300
                              Items: |-
                                =Filter(
                                    '[THFinanceCashCollection]Transactions',
                                    cr7bb_customer = _selectedEmail.cr7bb_customer &&
                                    cr7bb_processdate = _selectedEmail.cr7bb_processdate
                                )
                              TemplatePadding: =5
                              TemplateSize: =50
                              Width: =Parent.Width - 40
                            Children:
                              - TransRow:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    DropShadow: =DropShadow.None
                                    Fill: =RGBA(245, 245, 245, 1)
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutGap: =10
                                    LayoutMinHeight: =45
                                    LayoutMinWidth: =100
                                    PaddingBottom: =5
                                    PaddingLeft: =10
                                    PaddingRight: =10
                                    PaddingTop: =5
                                    RadiusBottomLeft: =5
                                    RadiusBottomRight: =5
                                    RadiusTopLeft: =5
                                    RadiusTopRight: =5
                                    Width: =Parent.TemplateWidth - 10
                                  Children:
                                    - TransRow_Info:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          FillPortions: =1
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutGap: =2
                                          LayoutMinHeight: =40
                                          LayoutMinWidth: =100
                                        Children:
                                          - TransRow_DocNumber:
                                              Control: Text@0.0.51
                                              Properties:
                                                AutoHeight: =true
                                                Font: =Font.Lato
                                                FontColor: =RGBA(0, 0, 0, 1)
                                                Size: =13
                                                Text: =ThisItem.cr7bb_documentnumber
                                                Weight: ='TextCanvas.Weight'.Semibold
                                                Width: =Parent.Width - 20
                                          - TransRow_Date:
                                              Control: Text@0.0.51
                                              Properties:
                                                AutoHeight: =true
                                                Font: =Font.Lato
                                                FontColor: =RGBA(100, 100, 100, 1)
                                                Size: =11
                                                Text: |-
                                                  =Text(ThisItem.cr7bb_documentdate, "dd/mm/yyyy") & " | Day " & Text(ThisItem.cr7bb_daycount)
                                                Weight: ='TextCanvas.Weight'.Regular
                                                Width: =Parent.Width - 20
                                    - TransRow_Amount:
                                        Control: Text@0.0.51
                                        Properties:
                                          FillPortions: =0
                                          Font: =Font.Lato
                                          FontColor: |-
                                            =If(
                                                ThisItem.cr7bb_transactiontype = 'Transaction Type Choice'.'Credit Note',
                                                RGBA(0, 128, 96, 1),
                                                RGBA(212, 41, 57, 1)
                                            )
                                          Height: =40
                                          Size: =14
                                          Text: |-
                                            ="฿" & Text(ThisItem.cr7bb_amountlocalcurrency, "#,##0.00")
                                          VerticalAlign: =VerticalAlign.Middle
                                          Weight: ='TextCanvas.Weight'.Bold
                                          Width: =100
                        - Preview_TotalSection:
                            Control: GroupContainer@1.3.0
                            Variant: AutoLayout
                            Properties:
                              DropShadow: =DropShadow.None
                              Fill: =RGBA(243, 242, 241, 1)
                              Height: =80
                              LayoutDirection: =LayoutDirection.Vertical
                              LayoutGap: =5
                              LayoutMinHeight: =80
                              LayoutMinWidth: =100
                              PaddingBottom: =10
                              PaddingLeft: =15
                              PaddingRight: =15
                              PaddingTop: =10
                              RadiusBottomLeft: =8
                              RadiusBottomRight: =8
                              RadiusTopLeft: =8
                              RadiusTopRight: =8
                              Width: =Parent.Width - 40
                            Children:
                              - Preview_TotalLabel:
                                  Control: Text@0.0.51
                                  Properties:
                                    AutoHeight: =true
                                    Font: =Font.Lato
                                    FontColor: =RGBA(0, 101, 161, 1)
                                    Size: =16
                                    Text: ="Total Amount"
                                    Weight: ='TextCanvas.Weight'.Bold
                                    Width: =Parent.Width - 30
                              - Preview_TotalAmount:
                                  Control: Text@0.0.51
                                  Properties:
                                    AutoHeight: =true
                                    Font: =Font.Lato
                                    FontColor: =RGBA(0, 0, 0, 1)
                                    Size: =20
                                    Text: |-
                                      ="฿" & Text(_selectedEmail.cr7bb_totalamount, "#,##0.00") & " THB"
                                    Weight: ='TextCanvas.Weight'.Bold
                                    Width: =Parent.Width - 30
            - EmailApprv_ActionBar:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.Regular
                  Fill: =RGBA(255, 255, 255, 1)
                  Height: =70
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  LayoutGap: =15
                  LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                  LayoutMinHeight: =70
                  LayoutMinWidth: =100
                  PaddingLeft: =20
                  PaddingRight: =20
                  RadiusBottomLeft: =8
                  RadiusBottomRight: =8
                  RadiusTopLeft: =8
                  RadiusTopRight: =8
                  Width: =Parent.Width - 20
                  X: =10
                  Y: =Parent.Height - 80
                Children:
                  - ActionBar_SelectionSummary:
                      Control: Text@0.0.51
                      Properties:
                        FillPortions: =1
                        Font: =Font.Lato
                        FontColor: =RGBA(50, 50, 50, 1)
                        Height: =50
                        Size: =14
                        Text: |-
                          ="Selected: " & CountRows(colSelectedEmails) & " emails | Total Amount: ฿" & Text(Sum(colSelectedEmails, cr7bb_totalamount), "#,##0.00") & " THB"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Semibold
                  - ActionBar_ButtonGroup:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =10
                        LayoutMinHeight: =50
                        LayoutMinWidth: =100
                      Children:
                        - ActionBar_ExcludeBtn:
                            Control: Button@0.0.45
                            Properties:
                              Appearance: ='ButtonCanvas.Appearance'.Secondary
                              BasePaletteColor: =RGBA(100, 100, 100, 1)
                              DisplayMode: |-
                                =If(
                                    CountRows(colSelectedEmails) > 0,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                              Height: =40
                              Icon: ="Cancel"
                              OnSelect: |-
                                =ForAll(
                                    colSelectedEmails,
                                    Patch(
                                        '[THFinanceCashCollection]Emaillogs',
                                        LookUp('[THFinanceCashCollection]Emaillogs', cr7bb_thfinancecashcollectionemaillogid = cr7bb_thfinancecashcollectionemaillogid),
                                        {
                                            cr7bb_sendstatus: 'Send Status Choice'.Failed,
                                            cr7bb_errormessage: "Manually excluded by AR team"
                                        }
                                    )
                                );
                                Remove(colDraftEmails, colSelectedEmails);
                                Clear(colSelectedEmails);
                                Notify("Excluded selected emails", NotificationType.Success);
                              Text: ="Exclude Selected"
                              Width: =150
                        - ActionBar_SendBtn:
                            Control: Button@0.0.45
                            Properties:
                              BasePaletteColor: =RGBA(0, 101, 161, 1)
                              DisplayMode: |-
                                =If(
                                    CountRows(colSelectedEmails) > 0 || gblAutoApprove,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                              Height: =40
                              Icon: ="Send"
                              OnSelect: |-
                                =If(
                                    gblAutoApprove,
                                    ClearCollect(colSelectedEmails, Filter(colDraftEmails, cr7bb_sendstatus = 'Send Status Choice'.Pending))
                                );
                                ForAll(
                                    colSelectedEmails,
                                    Patch(
                                        '[THFinanceCashCollection]Emaillogs',
                                        LookUp('[THFinanceCashCollection]Emaillogs', cr7bb_thfinancecashcollectionemaillogid = cr7bb_thfinancecashcollectionemaillogid),
                                        {cr7bb_sendstatus: 'Send Status Choice'.Approved}
                                    )
                                );
                                Notify(
                                    "Approved " & CountRows(colSelectedEmails) & " emails for sending. Power Automate will send within 5 minutes.",
                                    NotificationType.Success
                                );
                                Clear(colSelectedEmails);
                                Set(_refreshTrigger, !_refreshTrigger);
                              Text: ="Send Approved Emails"
                              Width: =180
            - EmailApprv_NavigationMenu:
                Control: CanvasComponent
                ComponentName: NavigationMenu
                Properties:
                  Fill: =RGBA(255, 255, 255, 0.5)
                  Height: =Parent.Height - 70
                  Visible: =If(_showMenu, true, false)
                  Width: =260
                  Y: =70
                  navItems: =Navigation
                  navSelected: =currentScreen
