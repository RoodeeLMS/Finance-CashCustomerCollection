Screens:
  scnFormPreview:
    Properties:
      Fill: =RGBA(243, 242, 241, 1)
      LoadingSpinnerColor: =RGBA(0, 101, 161, 1)
      OnVisible: |-
        =UpdateContext({currentScreen:"Evaluation Form"});
        Set(_showMenu,false);
        // Initialize preview mode and load questions
        If(IsBlank(gblCurrentQuestionIndex), Set(gblCurrentQuestionIndex, 1));
        // Build collection with question index
        ClearCollect(colFormPreviewQuestions,
            Sort(Filter('[THInterviewEval]FormQuestions', EvalForm.FormName = gblSelectedEvalForm.FormName), DisplayOrder)
        );
        Clear(colTestQuestions);
        ForAll(Sequence(CountRows(colFormPreviewQuestions)) As IndexNum,
            Collect(colTestQuestions,
                Patch(
                    Index(colFormPreviewQuestions, IndexNum.Value),
                    {QuestionIndex: IndexNum.Value}
                )
            )
        );
    Children:
      - FormPreview_MainContainer:
          Control: GroupContainer@1.3.0
          Variant: ManualLayout
          Properties:
            DropShadow: =DropShadow.Regular
            Height: =Parent.Height
            Width: =Parent.Width
          Children:
            - FormPreview_Header:
                Control: GroupContainer@1.3.0
                Variant: AutoLayout
                Properties:
                  DropShadow: =DropShadow.Regular
                  Fill: =RGBA(0, 101, 161, 1)
                  Height: =55
                  LayoutAlignItems: =LayoutAlignItems.Center
                  LayoutDirection: =LayoutDirection.Horizontal
                  PaddingLeft: =15
                  RadiusBottomLeft: =8
                  RadiusBottomRight: =8
                  RadiusTopLeft: =8
                  RadiusTopRight: =8
                  Width: =Parent.Width-20
                  X: =10
                  Y: =10
                Children:
                  - FormPreview_MenuIcon:
                      Control: Classic/Icon@2.5.0
                      Properties:
                        Color: =RGBA(255, 255, 255, 1)
                        Height: =50
                        Icon: =Icon.Hamburger
                        OnSelect: =Set(_showMenu,!_showMenu)
                        PaddingBottom: =10
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =10
                        Width: =50
                  - FormPreview_HeaderTitle:
                      Control: Text@0.0.51
                      Properties:
                        Font: =Font.Lato
                        FontColor: =Color.White
                        Height: =50
                        PaddingLeft: =20
                        Size: =25
                        Text: ="Form Preview"
                        VerticalAlign: =VerticalAlign.Middle
                        Weight: ='TextCanvas.Weight'.Medium
                        Width: =Parent.Width - FormPreview_MenuIcon.Width - 40
            - FormPreview_Content:
                Control: GroupContainer@1.3.0
                Variant: ManualLayout
                Properties:
                  Fill: =RGBA(255, 255, 255, 1)
                  Height: =Parent.Height-85
                  RadiusBottomLeft: =10
                  RadiusBottomRight: =10
                  RadiusTopLeft: =10
                  RadiusTopRight: =10
                  Width: =Parent.Width-20
                  X: =10
                  Y: =75
                Children:
                  - FormPreview_ProgressSection:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        Height: =90
                        LayoutAlignItems: =LayoutAlignItems.Stretch
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =10
                        PaddingBottom: =15
                        PaddingLeft: =20
                        PaddingRight: =20
                        PaddingTop: =15
                        Width: =Parent.Width
                      Children:
                        - FormPreview_ProgressText:
                            Control: Text@0.0.51
                            Properties:
                              Align: ='TextCanvas.Align'.Center
                              Font: =Font.Lato
                              Size: =16
                              Text: ="Question " & gblCurrentQuestionIndex & " of " & CountRows(colTestQuestions)
                              Weight: ='TextCanvas.Weight'.Semibold
                        - FormPreview_ProgressBar:
                            Control: Progress@1.1.34
                            Properties:
                              Height: =30
                              Max: =CountRows(colTestQuestions)
                              Value: =gblCurrentQuestionIndex
                  - FormPreview_FormInfo:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        Fill: =RGBA(247, 232, 211, 0.3)
                        Height: =50
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =15
                        PaddingLeft: =20
                        PaddingRight: =20
                        Width: =Parent.Width-40
                        X: =20
                        Y: =FormPreview_ProgressSection.Y + FormPreview_ProgressSection.Height + 10
                      Children:
                        - FormPreview_FormName:
                            Control: Text@0.0.51
                            Properties:
                              Font: =Font.Lato
                              FontColor: =RGBA(100, 81, 61, 1)
                              Size: =13
                              Text: |-
                                ="Form: " & gblSelectedEvalForm.FormName & " • Target: " & gblSelectedEvalForm.TargetPosition
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Parent.Width - 40
                  - FormPreview_QuestionSection:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        Height: =FormPreview_NavigationButtons.Y - Self.Y - 20
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =15
                        LayoutOverflowY: =LayoutOverflow.Scroll
                        PaddingBottom: =20
                        PaddingLeft: =20
                        PaddingRight: =20
                        PaddingTop: =20
                        Width: =Parent.Width-40
                        X: =20
                        Y: =FormPreview_FormInfo.Y + FormPreview_FormInfo.Height + 20
                      Children:
                        - FormPreview_CategoryTag:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              FontColor: =RGBA(0, 101, 161, 1)
                              Size: =12
                              Text: |-
                                =With(
                                    {currentQ: LookUp(colTestQuestions, QuestionIndex = gblCurrentQuestionIndex)},
                                    "Category: " & currentQ.QuestionCategory
                                )
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Parent.Width - 40
                        - FormPreview_QuestionText:
                            Control: Text@0.0.51
                            Properties:
                              AutoHeight: =true
                              Font: =Font.Lato
                              Size: =18
                              Text: |-
                                =With(
                                    {currentQ: LookUp(colTestQuestions, QuestionIndex = gblCurrentQuestionIndex)},
                                    currentQ.QuestionText
                                )
                              Weight: ='TextCanvas.Weight'.Semibold
                              Width: =Parent.Width - 40
                        - FormPreview_QuestionImage:
                            Control: Image@2.2.3
                            Properties:
                              BorderColor: =RGBA(0, 101, 161, 1)
                              Height: |-
                                =With(
                                    {_img: LookUp(colTestQuestions, QuestionIndex = gblCurrentQuestionIndex).QuestionImage},
                                    If(IsBlank(_img), 0, 200)
                                )
                              Image: =LookUp(colTestQuestions, QuestionIndex = gblCurrentQuestionIndex).QuestionImage
                              Width: =Parent.Width - 40
                        - FormPreview_ChoicesGallery:
                            Control: Gallery@2.15.0
                            Variant: BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0
                            Properties:
                              Height: =Min(400, Self.AllItemsCount * 70)
                              Items: |-
                                =Sort(
                                    Filter('[THInterviewEval]FormChoices',
                                        FormQuestion.'[THInterviewEval]FormQuestion' = LookUp(colTestQuestions, QuestionIndex = gblCurrentQuestionIndex).'[THInterviewEval]FormQuestion'
                                    ),
                                    Order
                                )
                              TemplatePadding: =5
                              TemplateSize: =70
                              Width: =Parent.Width - 40
                            Children:
                              - FormPreview_SelectionBar:
                                  Control: Rectangle@2.3.0
                                  Properties:
                                    BorderColor: =RGBA(0, 101, 161, 1)
                                    Fill: =RGBA(0, 101, 161, 1)
                                    Height: =Parent.TemplateHeight
                                    Visible: =false
                                    Width: =1
                              - FormPreview_ItemContainer:
                                  Control: GroupContainer@1.3.0
                                  Variant: AutoLayout
                                  Properties:
                                    DropShadow: =DropShadow.None
                                    Height: =Parent.TemplateHeight
                                    LayoutAlignItems: =LayoutAlignItems.Center
                                    LayoutDirection: =LayoutDirection.Horizontal
                                    LayoutGap: =16
                                    PaddingLeft: =16
                                    PaddingRight: =16
                                    Width: =Parent.TemplateWidth
                                  Children:
                                    - FormPreview_RadioCircle:
                                        Control: Circle@2.3.0
                                        Properties:
                                          BorderColor: =RGBA(0, 101, 161, 1)
                                          BorderThickness: =2
                                          Fill: =RGBA(255, 255, 255, 1)
                                          Height: =24
                                          Width: =24
                                    - FormPreview_TextContainer:
                                        Control: GroupContainer@1.3.0
                                        Variant: AutoLayout
                                        Properties:
                                          DropShadow: =DropShadow.None
                                          LayoutDirection: =LayoutDirection.Vertical
                                          LayoutGap: =2
                                          LayoutMinWidth: =200
                                        Children:
                                          - FormPreview_ChoiceText:
                                              Control: Label@2.5.1
                                              Properties:
                                                AutoHeight: =true
                                                Color: =RGBA(50, 49, 48, 1)
                                                Font: =Font.Lato
                                                Size: =14
                                                Text: =ThisItem.ChoiceText
                                                Width: =Parent.Width
                                          - FormPreview_ScoreText:
                                              Control: Label@2.5.1
                                              Properties:
                                                AutoHeight: =true
                                                Color: =RGBA(100, 81, 61, 1)
                                                Font: =Font.Lato
                                                FontWeight: =FontWeight.Semibold
                                                Size: =12
                                                Text: =ThisItem.Score & " " & If(ThisItem.Score = 1, "point", "points")
                                                Width: =Parent.Width
                  - FormPreview_NavigationButtons:
                      Control: GroupContainer@1.3.0
                      Variant: AutoLayout
                      Properties:
                        Height: =60
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Horizontal
                        LayoutGap: =10
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        PaddingLeft: =20
                        PaddingRight: =20
                        Width: =Parent.Width
                        Y: =Parent.Height - 70
                      Children:
                        - FormPreview_PrevBtn:
                            Control: Button@0.0.45
                            Properties:
                              BasePaletteColor: =RGBA(128, 128, 128, 1)
                              DisplayMode: =If(gblCurrentQuestionIndex > 1, DisplayMode.Edit, DisplayMode.Disabled)
                              Height: =40
                              OnSelect: =Set(gblCurrentQuestionIndex, gblCurrentQuestionIndex - 1)
                              Text: ="Previous"
                              Width: =120
                        - FormPreview_CloseBtn:
                            Control: Button@0.0.45
                            Properties:
                              BasePaletteColor: =RGBA(128, 128, 128, 1)
                              Height: =40
                              OnSelect: =Navigate(scnEvalFormLibrary)
                              Text: ="Close"
                              Width: =120
                        - FormPreview_NextBtn:
                            Control: Button@0.0.45
                            Properties:
                              BasePaletteColor: =RGBA(0, 101, 161, 1)
                              DisplayMode: =If(gblCurrentQuestionIndex < CountRows(colTestQuestions), DisplayMode.Edit, DisplayMode.Disabled)
                              Height: =40
                              OnSelect: =Set(gblCurrentQuestionIndex, gblCurrentQuestionIndex + 1)
                              Text: ="Next"
                              Width: =120
            - FormPreview_NavigationMenu:
                Control: CanvasComponent
                ComponentName: NavigationMenu
                Properties:
                  Fill: =RGBA(255, 255, 255, 0.5)
                  Height: =Parent.Height-70
                  Visible: =If(_showMenu,true,false)
                  Width: =260
                  Y: =70
                  navItems: =Navigation
                  navSelected: =currentScreen
